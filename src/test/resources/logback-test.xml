<configuration scan="true" scanPeriod="60 seconds">

    <timestamp key="timestamp" datePattern="yyyy-MM-dd'_'HH:mm:ss z"/>
    <conversionRule conversionWord="coloredLevel" converterClass="play.api.libs.logback.ColoredLevel" />

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder">
            <providers>
                <pattern>
                    <pattern>
                        {
                        "timestamp": "%date{ISO8601}",
                        "logger" : "%logger",
                        "level" : "%level",
                        "message" : "%message",
                        "thread" : "%thread",
                        "correlationId" : "%X{Correlation-ID}",
                        "contextName" : "%contextName"
                        }
                    </pattern>
                </pattern>
                <stackHash />
                <stackTrace>
                    <throwableConverter class="net.logstash.logback.stacktrace.ShortenedThrowableConverter">
                        <maxDepthPerThrowable>30</maxDepthPerThrowable>
                        <maxLength>4096</maxLength>
                        <shortenedClassNameLength>20</shortenedClassNameLength>
                        <rootCauseFirst>true</rootCauseFirst>
                    </throwableConverter>
                </stackTrace>
                <throwableClassName />
                <throwableRootCauseClassName />
                <context />
                <mdc />
                <tags />
                <logstashMarkers />
                <arguments />
            </providers>
        </encoder>
    </appender>

    <appender name="ASYNCSTDOUT" class="ch.qos.logback.classic.AsyncAppender">
        <includeCallerData>true</includeCallerData>
        <appender-ref ref="STDOUT" />
    </appender>

    <variable name="ROOT_LOG_LEVEL" value="${ROOT_LOG_LEVEL:-ERROR}" />
    <root level="${ROOT_LOG_LEVEL}">
        <appender-ref ref="ASYNCSTDOUT" />
    </root>

</configuration>
